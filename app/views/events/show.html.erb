<!--  This file is app/views/events/show.html.erb -->
<h2>Details about <em><%= @event.title %></em></h2>

<ul id="details">
  <li>
    Host:
    <%= @event.host %>
  </li>
  <li>
    Host Rating:
    <%= @user_rating %>
  </li>
  <li>
    Event Time:
    <%= @event.event_time %>
  </li>
  <li>
    Event Status:
    <%= @event.status %>
  </li>
  <li>
    Maximum Number of Attendees:
    <%= @event.attendee_limit %>
  </li>
  <li>
    People:
    <%= @event.people %>
  </li>
</ul>

<h3>Description:</h3>
<p id="description">
  <%= @event.description %>
</p>

<div class="row">
  <% if (@is_viewer_host) %>
    <%= link_to 'Edit', edit_event_path(@event), :class => 'btn btn-primary col-2' %>
    <%= link_to 'Delete', event_path(@event), 'data-method' => 'delete', 'data-confirm' => 'Are you sure?', :class => 'btn btn-danger col-2' %>
  <% end %>
  <%= link_to 'Back to event list', events_path, :class => 'btn btn-primary col-2' %>
  <%# Join: if user is not host && there's space %>
  <% if (!@is_viewer_host) %>
  <%= link_to @join_text, join_path({:id=>@event.id}), :class => @join_btn_style, :id => 'join_btn'%>
  <% end %>
</div>

<br>
<h3 class="details_padding">📒Comments </h3>
<table class="table table-striped col-md-12" id="comments">
  <thead>
    <tr>
      <th>👤User</th>
      <th>🖊️Comment</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @event.comments.each do |comment| %>
      <tr>
        <td>
          <%= comment.user.username %>
        </td>
        <td>
          <%= comment.content %>
        </td>
        <td>
          <% if (comment.user.username == @username) %>
            <%= link_to 'Edit', edit_event_comment_path(@event, comment.id), :class => 'btn btn-secondary col-4' %>
            <%= link_to 'Delete', event_comment_path(@event, comment.id), 'data-method' => 'delete', 'data-confirm' => 'Are you sure?', :class => 'btn btn-danger col-4' %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= form_tag event_comments_path(@event), :class => 'form' do %>
  <%= label :comment, '', :class => 'col-form-label' %>
  <%= text_field :comment, :content, :class => 'form-control', placeholder: 'Leave a quick comment (length limit: 100)', maxlength: 100 %>
  <br>
  <%= submit_tag 'Post Comment', :class => 'btn btn-primary' %>
<% end %>
</div>
